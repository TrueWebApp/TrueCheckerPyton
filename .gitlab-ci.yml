stages:
  - test
  - release


linters:
  image: python:3.8-slim-buster
  stage: test
  script:
    - pip install mypy flake8 black
    - mypy truecheker/
    - flake truecheker/
    - black truecheker/


pytest:
  stage: test
  image: python:3.8-slim-buster
  script:
    - pip install pytest pytest-cov
    - pytest --cov=truechecker/ tests/
    - coverage xml
  artifacts:
    reports:
      cobertura: coverage.xml


pypi:
  image: python:3.8-slim-buster
  stage: release
  cache: { }
  script:
    - pip install -U twine
    - python setup.py sdist
    - twine upload dist/*
  only:
    - tags
